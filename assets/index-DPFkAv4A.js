import{k as e,j,q as y,a7 as P,P as D,r as u,ab as I}from"./index-CJvg638n.js";import{u as S}from"./useQuery-DJ-tefVM.js";import{h as T,a as v}from"./automationService-CEnPLggJ.js";import{Q as x}from"./queryKey.const-4yptRpGc.js";import{B as h}from"./index-BAIjI0rE.js";import{u as _}from"./useMutation-DtMNI5dJ.js";import{T as q}from"./index-w6IqrXlL.js";import{D as b}from"./DeleteConfirmModal-CCC5Ho8A.js";import{u as C}from"./useTranslation-DN-CYzVf.js";import{S as E}from"./index-CWlqhW57.js";import{I as Q}from"./index-4M1x7pR3.js";import{P as $}from"./Pagination-BX02S7D7.js";import{T as m}from"./index-BXlHKc3j.js";import{u as k}from"./theme-D5S-1fEx.js";import{T as A}from"./Table-Bf5fO8hA.js";import"./__commonjsHelpers__-BosuxZz1.js";import"./utils-Dji2qSVF.js";import"./index-D8gngLx0.js";import"./index-DC1DAWbZ.js";import"./index-BtoCM6cC.js";import"./TextArea-DBRPcsh0.js";import"./CheckOutlined-CxiWyKpb.js";import"./index-TvTBJWU5.js";import"./gapSize-U1swVQyS.js";import"./EyeOutlined-B-Yk7nA6.js";import"./SearchOutlined-Bmw6m_pM.js";import"./LeftOutlined-_e4uGCQm.js";import"./responsiveObserver-BQm3ddGk.js";import"./index-Wc0f9ZXJ.js";import"./Overflow-eyj8oHJy.js";import"./PurePanel-BiIzqeBG.js";import"./DownOutlined-BgG6dx4I.js";import"./addEventListener-0hYE1V1V.js";import"./index-DwCW4jpE.js";import"./index-Db4idn_r.js";import"./Dropdown-DXC0sGt_.js";import"./extendsObject-EOfQw3bh.js";import"./EllipsisOutlined-DODEOrOr.js";import"./collapse-C1MjllT7.js";import"./index-DRCSt6Z6.js";const K=({data:o})=>{const t=j(),{modal:a,message:r}=y.useApp(),{t:n}=C(),{mutate:l}=_({mutationFn:()=>T([o.id]),onSuccess:()=>{t.invalidateQueries(x.campaign),r.success(n("Campaign deleted!"))},onError:()=>{r.error(n("Campaign delete error!"))}}),c=s=>{s.stopPropagation();const d={html:`<div>You want to delete campaign: <span class="text-[#417AFF]">${o.name}</span></div>`};b(d).then(async f=>{f.isConfirmed&&l()})};return e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(h,{label:n("Delete"),solid:1,typebutton:"error",classStyle:"w-fit",onClick:c})})},z=({record:o})=>e.jsx(P,{to:`${D.campaign}/${o.id}`,children:e.jsx(q,{className:"!text-[14px]",label:o.name})}),R=({idx:o})=>{const t=u.useContext(w),a=(t==null?void 0:t.searchState.page)-1;return e.jsx(e.Fragment,{children:a*(t==null?void 0:t.searchState.limit)+o+1})},O=[{title:e.jsx(m,{title:"No.STT"}),align:"center",render:(o,t,a)=>e.jsx(R,{idx:a})},{title:e.jsx(m,{title:"Name"}),dataIndex:"name",align:"center",render:(o,t)=>e.jsx(z,{record:t})},{title:e.jsx(m,{title:"Total profile"}),align:"center",dataIndex:"total_profile"},{title:e.jsx(m,{title:"Total profile pending"}),align:"center",dataIndex:"total_profile_pending"},{title:e.jsx(m,{title:"Total profile running"}),align:"center",dataIndex:"total_profile_running"},{title:e.jsx(m,{title:"Total profile success"}),align:"center",dataIndex:"total_profile_success"},{title:e.jsx(m,{title:"Total profile error"}),align:"center",dataIndex:"total_profile_error"},{title:e.jsx(m,{title:"Action"}),align:"center",render:(o,t)=>e.jsx(K,{data:t})}];function B({searchState:o,selectedRowKeys:t,setSelectedRowKeys:a}){const r=k(),{data:n={}}=S({queryFn:()=>v(o),queryKey:[x.campaign,o],refetchOnWindowFocus:!0}),{campaigns:l=[]}=n,s={selectedRowKeys:t,onChange:p=>{a(p)}};return e.jsx(e.Fragment,{children:e.jsx(A,{style:{borderColor:r.borderNormal},className:"mt-[10px] overflow-auto border-[.5px] border-solid shadow-sm rounded-lg",dataSource:l,columns:O,rowSelection:s,rowKey:"id",pagination:!1})})}function H({setSearchState:o,selected:t,setSelectedRowKeys:a}){const[r,n]=u.useState(""),l=j(),{message:c}=y.useApp(),{t:s}=C(),p=u.useRef(null),{mutate:d}=_({mutationFn:()=>T(t),onSuccess:()=>{a([]),l.invalidateQueries(x.campaign),c.success("Campaign deleted!")},onError:()=>{c.error("Campaign delete error!")}}),f=i=>{I.isEmpty(t)||(i.stopPropagation(),b().then(async g=>{g.isConfirmed&&d()}))},F=()=>{var g;const i=(g=p.current)==null?void 0:g.input;n((i==null?void 0:i.value)??""),o(N=>({...N,page:1,search:r}))};return e.jsxs(E,{className:"mt-6",children:[e.jsx(Q,{ref:p,className:"w-[350px]",placeholder:s("Search by campaign name"),value:r,onChange:i=>n(i.target.value),onPressEnter:F}),e.jsx(h,{label:s("Search"),typebutton:"primary",solid:!0,onClick:()=>o(i=>({...i,page:1,search:r}))}),t.length>0&&e.jsx(h,{onClick:f,label:`${s("Delete")} ${t.length} ${t.length>1?s("records"):s("record")}`,typebutton:"error"})]})}const M=({searchState:o,setSearchState:t})=>{const{t:a}=C(),r=(...c)=>{const[s,p]=c;t(d=>({...d,page:s,limit:p}))},{data:n={}}=S({queryFn:()=>v(o),queryKey:[x.campaign,o],refetchOnMount:!0,refetchOnWindowFocus:!0}),{total:l=0}=n;return e.jsx(e.Fragment,{children:l>0&&e.jsx($,{size:"default",showTitle:!1,showQuickJumper:!0,pageSize:o.limit,current:o.page,pageSizeOptions:[10,20,50,100],total:l,onChange:r,showSizeChanger:!0,locale:{items_per_page:a("page"),jump_to:a("Go to"),page:a("Page")}})})},w=u.createContext(void 0);function Ie(){const[o,t]=u.useState({search:"",page:1,limit:10}),[a,r]=u.useState([]),n={searchState:o};return e.jsxs(w.Provider,{value:n,children:[e.jsxs("div",{className:"h-[calc(100vh-130px)] flex flex-col gap-[10px] overflow-hidden pr-4",children:[e.jsx(H,{selected:a,setSearchState:t,setSelectedRowKeys:r}),e.jsx(B,{searchState:o,selectedRowKeys:a,setSelectedRowKeys:r})]}),e.jsx("div",{className:"h-[64px] flex justify-end items-center px-2",children:e.jsx(M,{searchState:o,setSearchState:t})})]})}export{w as CampaignContext,Ie as default};
