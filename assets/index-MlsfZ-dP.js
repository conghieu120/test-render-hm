import{i as N,aX as _,aY as F,aZ as B,r as m,q as P,j as E,k as e,w as v,ag as A,O as S,a_ as Q,N as b,ae as q}from"./index-CJvg638n.js";import{u as w}from"./useQuery-DJ-tefVM.js";import{B as D}from"./index-BAIjI0rE.js";import{Q as u}from"./queryKey.const-4yptRpGc.js";import{D as I}from"./DeleteConfirmModal-CCC5Ho8A.js";import{u as y}from"./theme-D5S-1fEx.js";import{P as O}from"./Pagination-BScioCE-.js";import{T as L}from"./index-w6IqrXlL.js";import{u as T}from"./useTranslation-DN-CYzVf.js";import{P as $}from"./index-D7PKG-E_.js";import{F as z}from"./index-jmQoDNPY.js";import{f as H,g as k,h as K,i as M}from"./index.esm-mlJjdzQr.js";import{T as x}from"./index-BXlHKc3j.js";import{C as Y}from"./index.esm-B_Vby5oa.js";import{T as U}from"./Table-Bf5fO8hA.js";import"./__commonjsHelpers__-BosuxZz1.js";import"./utils-Dji2qSVF.js";import"./index-TvTBJWU5.js";import"./Pagination-BX02S7D7.js";import"./LeftOutlined-_e4uGCQm.js";import"./responsiveObserver-BQm3ddGk.js";import"./index-Wc0f9ZXJ.js";import"./index-BtoCM6cC.js";import"./index-DC1DAWbZ.js";import"./Overflow-eyj8oHJy.js";import"./PurePanel-BiIzqeBG.js";import"./TextArea-DBRPcsh0.js";import"./CheckOutlined-CxiWyKpb.js";import"./DownOutlined-BgG6dx4I.js";import"./SearchOutlined-Bmw6m_pM.js";import"./index-D8gngLx0.js";import"./gapSize-U1swVQyS.js";import"./addEventListener-0hYE1V1V.js";import"./index-DwCW4jpE.js";import"./index-Db4idn_r.js";import"./Dropdown-DXC0sGt_.js";import"./extendsObject-EOfQw3bh.js";import"./EllipsisOutlined-DODEOrOr.js";import"./collapse-C1MjllT7.js";import"./index-CWlqhW57.js";import"./index-DRCSt6Z6.js";import"./index-4M1x7pR3.js";import"./EyeOutlined-B-Yk7nA6.js";const R=async t=>{const r={...t};return delete r.type,N.get(_,{params:r})},W=async t=>await N.delete(`${B}/${t}`),G=async t=>N.post(F,t),j=m.createContext({confirmDelete:async(t,r)=>{},handleRestore:async t=>{}});function J({children:t}){const{modal:r,message:a}=P.useApp(),o=E(),[i,l]=m.useState([]),s=async d=>{Promise.all(d.map(async c=>{try{return await W(c),!0}catch(n){return n.response.data}})).then(c=>{c.every(n=>n===!0)?(a.success("Delete success."),o.invalidateQueries(u.recycles)):c.every(n=>n.type==="error")&&a.error(c[0].title)})},f={confirmDelete:async(d,c)=>{I().then(async n=>{n.isConfirmed&&await s(d)}),l(d)},handleRestore:async d=>{await G({uuid_browser:d}).then(()=>{o.invalidateQueries(u.recycles),o.invalidateQueries(u.listProfile,{refetchInactive:!0}),o.invalidateQueries(u.PROFILE_CLOUD,{refetchInactive:!0}),a.success("Restore Success")}).catch(c=>{const n=c.response.data;n.title&&n.content.length>0?n.content.forEach(p=>{a.error(p)}):a.error(n.title)})}};return e.jsx(j.Provider,{value:f,children:t})}function V({selectedRowKeys:t,dataFilter:r,setDataFilter:a}){const o=y();v.useToken();const{confirmDelete:i,handleRestore:l}=m.useContext(j);return w({queryFn:()=>R(r),queryKey:[u.recycles,r]}),m.useState(""),e.jsx(e.Fragment,{children:e.jsx("div",{style:{backgroundColor:o.backgroundNormal},className:(t.length>0?"visible":"invisible")+" pt-2 pb-5",children:e.jsxs("div",{className:"flex justify-start gap-3",children:[e.jsx(D,{icon:e.jsx(A,{}),label:S("Delete"),onClick:()=>{i(t,!0)},typebutton:"error"}),e.jsx(D,{icon:e.jsx(Q,{}),label:S("Restore"),onClick:()=>{l(t)},typebutton:"error"})]})})})}function X({dataFilter:t,setDataFilter:r}){const{token:{colorBorder:a}}=v.useToken(),o=y(),{t:i}=T(),l=(...f)=>{const[d,c]=f;r(n=>({...n,page:d,limit:c}))},{data:s}=w({queryFn:()=>R(t),queryKey:[u.recycles,t]}),h=Number(t.limit),C=Number(t.page);return e.jsxs("div",{className:"w-full h-[64px] p-4 gap-x-2 flex items-center justify-end",style:{backgroundColor:o.backgroundNormal,borderColor:a},children:[e.jsx("div",{className:"",children:e.jsx(L,{className:"!text-[16px]",label:`${((s==null?void 0:s.data.meta.total)||0)>1?i("Profiles"):i("Profile")}: ${(s==null?void 0:s.data.meta.total)||0}`})}),e.jsx(O,{showTitle:!1,showQuickJumper:!0,pageSize:isNaN(h)?15:h,current:C,pageSizeOptions:[15,20,25,50,100],total:(s==null?void 0:s.data.meta.total)||0,onChange:l,showSizeChanger:!0,locale:{items_per_page:i("page")}})]})}const Z=({data:t})=>{const{confirmDelete:r}=m.useContext(j),{t:a}=T(),o=[{type:a("Delete"),action:()=>r([t.uuid],!0),icon:e.jsx(A,{})}];return e.jsx(e.Fragment,{children:o.map((i,l)=>e.jsx("div",{children:e.jsx(b,{type:"text",icon:i.icon,onClick:i.action,className:"font-medium text-[14px] leading-[21px] w-full h-full gap-[5px] flex items-center text-base",children:i.type})},l))})};function ee({data:t}){return e.jsx($,{content:e.jsx(Z,{data:t}),trigger:"click",arrow:!1,placement:"rightTop",children:e.jsx(b,{type:"text",shape:"circle",icon:e.jsx(q,{})})})}function te({item:t}){const{handleRestore:r}=m.useContext(j),{t:a}=T();return e.jsx(e.Fragment,{children:e.jsxs(z,{gap:"10px",justify:"center",className:" text-center ml-6",children:[e.jsx(b,{className:"flex items-center bg-red-500 text-white",onClick:()=>{r([t.uuid])},children:a("Restore")}),e.jsx(ee,{data:t})]})})}const re=t=>{const r=new Date(t),a={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0};return new Intl.DateTimeFormat("en-US",a).format(r)},se=[{title:e.jsx(x,{title:"Name Profiles"}),align:"center",dataIndex:"name",showSorterTooltip:!1,render:t=>e.jsx("div",{className:"flex items-center gap-1",children:t}),sorter:!0},{title:e.jsx(x,{title:"System"}),align:"center",dataIndex:"os",render:t=>e.jsx("p",{className:"m-0  text-xl",children:t==="win"?e.jsx(H,{className:"text-[#0078D4]"}):t==="mac"?e.jsx(k,{className:"text-[#A6B1B7]"}):t==="lin"?e.jsx(K,{}):t==="android"?e.jsx(M,{className:"text-[#AAC148]"}):t==="ios"?e.jsx(k,{className:"text-[#A6B1B7]"}):e.jsx(Y,{className:"text-[#A6B1B7]"})})},{title:e.jsx(x,{title:"Version"}),align:"center",dataIndex:"version",render:t=>e.jsx("div",{className:"",children:t})},{title:e.jsx(x,{title:"Time Remaining"}),align:"center",dataIndex:"time_remaining",render:t=>e.jsx("div",{children:t})},{title:e.jsx(x,{title:"Delete at"}),align:"center",dataIndex:"delete_at",render:t=>re(t)},{title:e.jsx(x,{title:"Action"}),align:"center",render:t=>e.jsx(te,{item:t})}],ne={"header-fixed":"_header-fixed_8q965_1"};function ae({columns:t,selectedRowKeys:r,dataFilter:a,setSelectedRowKeys:o,setDataFilter:i}){const l=E();y();const{data:s,isFetching:h}=w({queryFn:()=>R(a),queryKey:[u.recycles,a],onSuccess:c=>{const n=c.data.data.content.filter(p=>r.includes(p.uuid));o(n)}}),f={selectedRowKeys:r,onChange:c=>{o(c)}};m.useEffect(()=>{l.invalidateQueries(u.recycles)},[]);const d=(c,n,p)=>{p.order==="ascend"?i(g=>({...g,orderName:1})):p.order==="descend"?i(g=>({...g,orderName:2})):i(g=>({...g,orderName:0}))};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"overflow-auto w-full",style:{height:"calc(100vh-64px)"},children:e.jsx(U,{rowSelection:f,columns:t,rowKey:"uuid",loading:{spinning:h},className:`${ne["header-fixed"]}`,rowClassName:(c,n)=>n===3?"scroll-row":"",dataSource:(s==null?void 0:s.data.data.content)||[],pagination:!1,onChange:d})})})}const oe={page:1,limit:15,search:"",type:"owner",orderName:0};function Je(){const t=y();v.useToken();const[r,a]=m.useState(se),[o,i]=m.useState([]),[l,s]=m.useState(oe);return m.useEffect(()=>{i([])},[l]),e.jsx(e.Fragment,{children:e.jsx(J,{children:e.jsxs("div",{className:"flex flex-col h-full pr-5",children:[e.jsxs("div",{className:"overflow-y-hidden flex flex-col relative",style:{flex:1},children:[e.jsx(V,{selectedRowKeys:o,dataFilter:l,setDataFilter:s}),e.jsx("div",{id:"table-hidemium",className:"h-[calc(100vh-200px)] mr-5 rounded-lg border border-solid shadow-sm overflow-auto",style:{backgroundColor:t.backgroundLight,borderColor:t.borderNormal},children:e.jsx(ae,{columns:r,selectedRowKeys:o,dataFilter:l,setSelectedRowKeys:i,setDataFilter:s})})]}),e.jsx(X,{dataFilter:l,setDataFilter:s})]})})})}export{Je as default,oe as defaultStateRecycle};
