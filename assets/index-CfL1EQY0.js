import{k as t,r as c,i as x,cF as T,cG as N,cH as F,l as v}from"./index-CJvg638n.js";import{H as R}from"./HeaderContext-CcFwS_UE.js";import{u as f}from"./useQuery-DJ-tefVM.js";import{Q as h}from"./queryKey.const-4yptRpGc.js";import{T as d}from"./index-BXlHKc3j.js";import{P as _}from"./Pagination-BX02S7D7.js";import{u as b}from"./theme-D5S-1fEx.js";import{T as H}from"./Table-Bf5fO8hA.js";import{g as k}from"./auth-8cqRmsX-.js";import{g as A}from"./chargeService-C2W2Kfb4.js";import{u as E}from"./useTranslation-DN-CYzVf.js";import{R as D,C as S}from"./row-C7cWNtLw.js";import{S as q}from"./index-Bsl0EBBv.js";import{T as I}from"./index-D8gngLx0.js";import"./__commonjsHelpers__-BosuxZz1.js";import"./index-w6IqrXlL.js";import"./index-BAIjI0rE.js";import"./index-Cn7Yo5Hv.js";import"./PurePanel-BiIzqeBG.js";import"./index-4M1x7pR3.js";import"./TextArea-DBRPcsh0.js";import"./index-DC1DAWbZ.js";import"./EyeOutlined-B-Yk7nA6.js";import"./SearchOutlined-Bmw6m_pM.js";import"./index-DGGwne6Z.js";import"./EllipsisOutlined-DODEOrOr.js";import"./Overflow-eyj8oHJy.js";import"./index-BtoCM6cC.js";import"./PlusOutlined-B9MlVXp_.js";import"./Dropdown-DXC0sGt_.js";import"./utils-Dji2qSVF.js";import"./LeftOutlined-_e4uGCQm.js";import"./responsiveObserver-BQm3ddGk.js";import"./index-Wc0f9ZXJ.js";import"./CheckOutlined-CxiWyKpb.js";import"./DownOutlined-BgG6dx4I.js";import"./addEventListener-0hYE1V1V.js";import"./index-DwCW4jpE.js";import"./index-Db4idn_r.js";import"./extendsObject-EOfQw3bh.js";import"./collapse-C1MjllT7.js";import"./index-CWlqhW57.js";import"./gapSize-U1swVQyS.js";import"./index-DRCSt6Z6.js";function z(){return t.jsx(R,{namePage:"Payment history"})}const C=[{title:t.jsx(d,{title:"No.STT"}),align:"center",render:(e,a,o)=>{const i=a.page?a.page-1:0,n=a.limit||0;return i*n+o+1}},{title:t.jsx(d,{title:"Name"}),align:"center",dataIndex:"name"},{title:t.jsx(d,{title:"Payment method"}),align:"center",dataIndex:"payment_method",render:e=>{let a="";switch(e){case"NoBank":a="Balance";break;case"Paypal":a="Paypal";break;case"Vietcombank":a="Balance";break;case"Coinbase Crypto":a="Balance";break;default:a=e;break}return a}},{title:t.jsx(d,{title:"Price"}),align:"center",dataIndex:"price"},{title:t.jsx(d,{title:"Activated on"}),align:"center",dataIndex:"activated_on"},{title:t.jsx(d,{title:"Expires on"}),align:"center",dataIndex:"expires_on"}],K={page:1,limit:15},O={dataFilter:K},y=c.createContext({filterState:{},setFilterState:e=>{},columns:C,setColumns:e=>{}});function U({children:e}){const[a,o]=c.useState(C),[i,n]=c.useState(O),m={filterState:i,setFilterState:n,setColumns:o,columns:a};return t.jsx(y.Provider,{value:m,children:e})}const P=async e=>await x.get(T,{params:e}),B=async e=>await x.put(F,e),G=async e=>await x.get(N,{params:e});function $(){const{filterState:e,setFilterState:a}=c.useContext(y),o=(...p)=>{const[l,s]=p;a(r=>({...r,dataFilter:{...r,page:l,limit:s}}))},{data:i}=f({queryFn:()=>P(e.dataFilter),queryKey:[h.listPaymentHistory,e.dataFilter]}),n=Number(e.dataFilter.limit),m=Number(e.dataFilter.page);return t.jsx("div",{className:"w-full p-4 gap-x-2 flex items-center justify-end",children:t.jsx(_,{showTitle:!1,pageSize:isNaN(n)?15:n,current:m,pageSizeOptions:[15,25,50,100],total:(i==null?void 0:i.data.meta.total)||0,onChange:o,showSizeChanger:!0})})}const M={"header-fixed":"_header-fixed_8q965_1"};function Q(){b();const{columns:e,filterState:a}=c.useContext(y),{data:o}=f({queryFn:()=>P(a.dataFilter),queryKey:[h.listPaymentHistory,a.dataFilter]});return t.jsx("div",{className:"w-full h-full overflow-auto",children:t.jsx(H,{columns:e,rowKey:"uuid",className:`${M["header-fixed"]} w-full`,dataSource:(o==null?void 0:o.data.data.content)||[],rowClassName:(i,n)=>n===3?"scroll-row":"",pagination:!1})})}function Y(){const{t:e}=E(),{Text:a}=I,[o,i]=c.useState(""),[n,m]=c.useState(!1);f({queryFn:()=>k(),queryKey:h.userDetail,onSuccess:async l=>{var u,g,w,j;const s=await A((u=l==null?void 0:l.data)==null?void 0:u.content),r=new Date((j=(w=(g=s==null?void 0:s.data)==null?void 0:g.content)==null?void 0:w.charge)==null?void 0:j.expires_on);r.setDate(r.getDate()-1),i(r.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))},refetchOnMount:!0});const p=l=>{B({key:"recharge_auto",value:l}).then(r=>{var u;m((u=r==null?void 0:r.data)==null?void 0:u.content)})};return c.useEffect(()=>{G({default:!0}).then(s=>{var r;m((r=s==null?void 0:s.data)==null?void 0:r.content)})},[]),t.jsxs(D,{children:[t.jsxs(S,{span:24,className:"mb-3",children:[t.jsx(a,{className:"font-bold text-[14px]",children:e("Automatic Renewal")}),t.jsx(v,{theme:{token:{colorPrimary:"#1777FF"}}}),t.jsx(q,{className:"ml-5",onChange:p,checked:n})]}),n&&t.jsx(S,{span:24,className:"mb-3",children:t.jsx(a,{className:"text-[14px]",children:`${e("Your plan will automatically renew on:")} ${o}`})})]})}function zt(){const e=b();return t.jsx(U,{children:t.jsx("div",{className:"flex flex-col h-full",children:t.jsxs("div",{className:"rounded-tl-md h-full overflow-y-hidden overflow-x-hidden flex flex-col relative pr-4",children:[t.jsx(z,{}),t.jsx(Y,{}),t.jsx("div",{id:"table-hidemium",className:"h-[calc(100vh-200px)] mr-5 rounded-lg border border-solid shadow-sm overflow-auto",style:{backgroundColor:e.backgroundLight,borderColor:e.borderNormal},children:t.jsx(Q,{})}),t.jsx($,{})]})})})}export{zt as default};
