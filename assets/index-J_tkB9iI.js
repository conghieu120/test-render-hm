import{i as v,aX as _,aY as B,aZ as F,r as u,q as P,j as D,k as e,ag as E,O as R,a_ as Q,w as k,N as A,ae as q}from"./index-rD5D3wIe.js";import{u as b}from"./useQuery-DGelT77v.js";import{B as N}from"./index-Cnfr_LhE.js";import{Q as d}from"./queryKey.const-4yptRpGc.js";import{D as I}from"./DeleteConfirmModal-DSBDXsxU.js";import{u as y}from"./theme-CwYL3eQV.js";import{P as O}from"./Pagination-BR-nqofd.js";import{T as L}from"./index-CwHt7GoT.js";import{u as w}from"./useTranslation-CdVDZguR.js";import{P as $}from"./index-Dv8E0b5H.js";import{F as M}from"./index-C7QdTRRe.js";import{f as z,g as S,h as H,i as K}from"./index.esm-By9H6xJu.js";import{T as x}from"./index-e-kTAu8U.js";import{C as Y}from"./index.esm-Clfs4ZBd.js";import{T as U}from"./Table-CkCjhjFV.js";import"./commonjsHelpers__-BosuxZz1.js";import"./utils-Dji2qSVF.js";import"./index-bFDahTXa.js";import"./Pagination-Du9klKsI.js";import"./LeftOutlined-hwnj7f46.js";import"./responsiveObserver-CoLEQsUO.js";import"./index-Cw8dqNCZ.js";import"./index-BUNugdcr.js";import"./index-VaFpLiuL.js";import"./Overflow-wzPxOxK8.js";import"./PurePanel-CzAY4fQy.js";import"./TextArea-D8GM8mUo.js";import"./CheckOutlined-CxcD5R4P.js";import"./DownOutlined-U_yyBD4s.js";import"./SearchOutlined-DPpNmpde.js";import"./index-WqkPP-4X.js";import"./gapSize-U1swVQyS.js";import"./addEventListener-Dnrwfmdl.js";import"./index-C97G-hLo.js";import"./index-c2ufQ9kY.js";import"./Dropdown-BA274VvY.js";import"./extendsObject-BTpHJDoQ.js";import"./EllipsisOutlined-Cvv2ECO7.js";import"./collapse-C1MjllT7.js";import"./index-DEeuvegC.js";import"./index-Rll6gE4e.js";import"./index-R7zUTNyO.js";import"./EyeOutlined-D2K23cwb.js";const T=async t=>{const r={...t};return delete r.type,v.get(_,{params:r})},W=async t=>await v.delete(`${F}/${t}`),G=async t=>v.post(B,t),j=u.createContext({confirmDelete:async(t,r)=>{},handleRestore:async t=>{}});function J({children:t}){const{modal:r,message:s}=P.useApp(),a=D(),[i,l]=u.useState([]),n=async m=>{Promise.all(m.map(async c=>{try{return await W(c),!0}catch(o){return o.response.data}})).then(c=>{c.every(o=>o===!0)?(s.success("Delete success."),a.invalidateQueries(d.recycles)):c.every(o=>o.type==="error")&&s.error(c[0].title)})},h={confirmDelete:async(m,c)=>{I().then(async o=>{o.isConfirmed&&await n(m)}),l(m)},handleRestore:async m=>{await G({uuid_browser:m}).then(()=>{a.invalidateQueries(d.recycles),a.invalidateQueries(d.listProfile,{refetchInactive:!0}),a.invalidateQueries(d.PROFILE_CLOUD,{refetchInactive:!0}),s.success("Restore Success")}).catch(c=>{const o=c.response.data;o.title&&o.content.length>0?o.content.forEach(p=>{s.error(p)}):s.error(o.title)})}};return e.jsx(j.Provider,{value:h,children:t})}function V({selectedRowKeys:t,dataFilter:r}){const s=y(),{confirmDelete:a,handleRestore:i}=u.useContext(j);return b({queryFn:()=>T(r),queryKey:[d.recycles,r]}),e.jsx(e.Fragment,{children:e.jsx("div",{style:{backgroundColor:s.backgroundNormal},className:(t.length>0?"visible":"invisible")+" pt-2 pb-5",children:e.jsxs("div",{className:"flex justify-start gap-3",children:[e.jsx(N,{icon:e.jsx(E,{}),label:R("Delete"),buttonMenu:!0,onClick:()=>{a(t,!0)},type:"error"}),e.jsx(N,{icon:e.jsx(Q,{}),label:R("Restore"),buttonMenu:!0,onClick:()=>{i(t)},type:"normal"})]})})})}function X({dataFilter:t,setDataFilter:r}){const{token:{colorBorder:s}}=k.useToken(),a=y(),{t:i}=w(),l=(...h)=>{const[m,c]=h;r(o=>({...o,page:m,limit:c}))},{data:n}=b({queryFn:()=>T(t),queryKey:[d.recycles,t]}),f=Number(t.limit),C=Number(t.page);return e.jsxs("div",{className:"w-full h-[64px] p-4 gap-x-2 flex items-center justify-end",style:{backgroundColor:a.backgroundNormal,borderColor:s},children:[e.jsx("div",{className:"",children:e.jsx(L,{className:"!text-[16px]",label:`${((n==null?void 0:n.data.meta.total)||0)>1?i("Profiles"):i("Profile")}: ${(n==null?void 0:n.data.meta.total)||0}`})}),e.jsx(O,{showTitle:!1,showQuickJumper:!0,pageSize:isNaN(f)?15:f,current:C,pageSizeOptions:[15,20,25,50,100],total:(n==null?void 0:n.data.meta.total)||0,onChange:l,showSizeChanger:!0,locale:{items_per_page:i("page")}})]})}const Z=({data:t})=>{const{confirmDelete:r}=u.useContext(j),{t:s}=w(),a=[{type:s("Delete"),action:()=>r([t.uuid],!0),icon:e.jsx(E,{})}];return e.jsx(e.Fragment,{children:a.map((i,l)=>e.jsx("div",{children:e.jsx(A,{type:"text",icon:i.icon,onClick:i.action,className:"font-medium text-[14px] leading-[21px] w-full h-full gap-[5px] flex items-center text-base",children:i.type})},l))})};function ee({data:t}){return e.jsx($,{content:e.jsx(Z,{data:t}),trigger:"click",arrow:!1,placement:"rightTop",children:e.jsx(A,{type:"text",shape:"circle",icon:e.jsx(q,{})})})}function te({item:t}){const{handleRestore:r}=u.useContext(j),{t:s}=w();return e.jsx(e.Fragment,{children:e.jsxs(M,{gap:"10px",justify:"center",className:" text-center ml-6",children:[e.jsx(N,{type:"error",onClick:()=>{r([t.uuid])},label:s("Restore")}),e.jsx(ee,{data:t})]})})}const re=t=>{const r=new Date(t),s={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0};return new Intl.DateTimeFormat("en-US",s).format(r)},se=[{title:e.jsx(x,{title:"Name Profiles"}),align:"center",dataIndex:"name",showSorterTooltip:!1,render:t=>e.jsx("div",{className:"flex items-center gap-1",children:t}),sorter:!0},{title:e.jsx(x,{title:"System"}),align:"center",dataIndex:"os",render:t=>e.jsx("p",{className:"m-0  text-xl",children:t==="win"?e.jsx(z,{className:"text-[#0078D4]"}):t==="mac"?e.jsx(S,{className:"text-[#A6B1B7]"}):t==="lin"?e.jsx(H,{}):t==="android"?e.jsx(K,{className:"text-[#AAC148]"}):t==="ios"?e.jsx(S,{className:"text-[#A6B1B7]"}):e.jsx(Y,{className:"text-[#A6B1B7]"})})},{title:e.jsx(x,{title:"Version"}),align:"center",dataIndex:"version",render:t=>e.jsx("div",{className:"",children:t})},{title:e.jsx(x,{title:"Time Remaining"}),align:"center",dataIndex:"time_remaining",render:t=>e.jsx("div",{children:t})},{title:e.jsx(x,{title:"Delete at"}),align:"center",dataIndex:"delete_at",render:t=>re(t)},{title:e.jsx(x,{title:"Action"}),align:"center",render:t=>e.jsx(te,{item:t})}],ne={"header-fixed":"_header-fixed_8q965_1"};function oe({columns:t,selectedRowKeys:r,dataFilter:s,setSelectedRowKeys:a,setDataFilter:i}){const l=D();y();const{data:n,isFetching:f}=b({queryFn:()=>T(s),queryKey:[d.recycles,s],onSuccess:c=>{const o=c.data.data.content.filter(p=>r.includes(p.uuid));a(o)}}),h={selectedRowKeys:r,onChange:c=>{a(c)}};u.useEffect(()=>{l.invalidateQueries(d.recycles)},[]);const m=(c,o,p)=>{p.order==="ascend"?i(g=>({...g,orderName:1})):p.order==="descend"?i(g=>({...g,orderName:2})):i(g=>({...g,orderName:0}))};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"overflow-auto w-full",style:{height:"calc(100vh-64px)"},children:e.jsx(U,{rowSelection:h,columns:t,rowKey:"uuid",loading:{spinning:f},className:`${ne["header-fixed"]}`,rowClassName:(c,o)=>o===3?"scroll-row":"",dataSource:(n==null?void 0:n.data.data.content)||[],pagination:!1,onChange:m})})})}const ae={page:1,limit:15,search:"",type:"owner",orderName:0};function Je(){const t=y();k.useToken();const[r,s]=u.useState(se),[a,i]=u.useState([]),[l,n]=u.useState(ae);return u.useEffect(()=>{i([])},[l]),e.jsx(e.Fragment,{children:e.jsx(J,{children:e.jsxs("div",{className:"flex flex-col h-full pr-5",children:[e.jsxs("div",{className:"overflow-y-hidden flex flex-col relative",style:{flex:1},children:[e.jsx(V,{selectedRowKeys:a,dataFilter:l,setDataFilter:n}),e.jsx("div",{id:"table-hidemium",className:"h-[calc(100vh-200px)] mr-5 rounded-lg border border-solid shadow-sm overflow-auto",style:{backgroundColor:t.backgroundLight,borderColor:t.borderNormal},children:e.jsx(oe,{columns:r,selectedRowKeys:a,dataFilter:l,setSelectedRowKeys:i,setDataFilter:n})})]}),e.jsx(X,{dataFilter:l,setDataFilter:n})]})})})}export{Je as default,ae as defaultStateRecycle};
