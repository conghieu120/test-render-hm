import{k as e,j as C,q as j,a7 as P,P as D,r as u,ab as I}from"./index-rD5D3wIe.js";import{u as y}from"./useQuery-DGelT77v.js";import{h as S,a as T}from"./automationService-ItdDN5Ql.js";import{Q as x}from"./queryKey.const-4yptRpGc.js";import{B as f}from"./index-Cnfr_LhE.js";import{u as v}from"./useMutation-7pHNuXnK.js";import{T as q}from"./index-CwHt7GoT.js";import{D as _}from"./DeleteConfirmModal-DSBDXsxU.js";import{u as h}from"./useTranslation-CdVDZguR.js";import{S as E}from"./index-DEeuvegC.js";import{I as Q}from"./index-R7zUTNyO.js";import{P as $}from"./Pagination-Du9klKsI.js";import{T as m}from"./index-e-kTAu8U.js";import{u as k}from"./theme-CwYL3eQV.js";import{T as A}from"./Table-CkCjhjFV.js";import"./commonjsHelpers-BosuxZz1.js";import"./utils-Dji2qSVF.js";import"./index-WqkPP-4X.js";import"./index-VaFpLiuL.js";import"./index-BUNugdcr.js";import"./TextArea-D8GM8mUo.js";import"./CheckOutlined-CxcD5R4P.js";import"./index-bFDahTXa.js";import"./gapSize-U1swVQyS.js";import"./EyeOutlined-D2K23cwb.js";import"./SearchOutlined-DPpNmpde.js";import"./LeftOutlined-hwnj7f46.js";import"./responsiveObserver-CoLEQsUO.js";import"./index-Cw8dqNCZ.js";import"./Overflow-wzPxOxK8.js";import"./PurePanel-CzAY4fQy.js";import"./DownOutlined-U_yyBD4s.js";import"./addEventListener-Dnrwfmdl.js";import"./index-C97G-hLo.js";import"./index-c2ufQ9kY.js";import"./Dropdown-BA274VvY.js";import"./extendsObject-BTpHJDoQ.js";import"./EllipsisOutlined-Cvv2ECO7.js";import"./collapse-C1MjllT7.js";import"./index-Rll6gE4e.js";const K=({data:o})=>{const t=C(),{message:r}=j.useApp(),{t:a}=h(),{mutate:n}=v({mutationFn:()=>S([o.id]),onSuccess:()=>{t.invalidateQueries(x.campaign),r.success(a("Campaign deleted!"))},onError:()=>{r.error(a("Campaign delete error!"))}}),l=p=>{p.stopPropagation();const c={html:`<div>You want to delete campaign: <span class="text-[#417AFF]">${o.name}</span></div>`};_(c).then(async d=>{d.isConfirmed&&n()})};return e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(f,{label:a("Delete"),type:"error",onClick:l})})},z=({record:o})=>e.jsx(P,{to:`${D.campaign}/${o.id}`,children:e.jsx(q,{className:"!text-[14px]",label:o.name})}),R=({idx:o})=>{const t=u.useContext(w),r=(t==null?void 0:t.searchState.page)-1;return e.jsx(e.Fragment,{children:r*(t==null?void 0:t.searchState.limit)+o+1})},M=[{title:e.jsx(m,{title:"No.STT"}),align:"center",render:(o,t,r)=>e.jsx(R,{idx:r})},{title:e.jsx(m,{title:"Name"}),dataIndex:"name",align:"center",render:(o,t)=>e.jsx(z,{record:t})},{title:e.jsx(m,{title:"Total profile"}),align:"center",dataIndex:"total_profile"},{title:e.jsx(m,{title:"Total profile pending"}),align:"center",dataIndex:"total_profile_pending"},{title:e.jsx(m,{title:"Total profile running"}),align:"center",dataIndex:"total_profile_running"},{title:e.jsx(m,{title:"Total profile success"}),align:"center",dataIndex:"total_profile_success"},{title:e.jsx(m,{title:"Total profile error"}),align:"center",dataIndex:"total_profile_error"},{title:e.jsx(m,{title:"Action"}),align:"center",render:(o,t)=>e.jsx(K,{data:t})}];function O({searchState:o,selectedRowKeys:t,setSelectedRowKeys:r}){const a=k(),{data:n={}}=y({queryFn:()=>T(o),queryKey:[x.campaign,o],refetchOnWindowFocus:!0}),{campaigns:l=[]}=n,i={selectedRowKeys:t,onChange:c=>{r(c)}};return e.jsx(e.Fragment,{children:e.jsx(A,{style:{borderColor:a.borderNormal},className:"mt-[10px] overflow-auto border-[.5px] border-solid shadow-sm rounded-lg",dataSource:l,columns:M,rowSelection:i,rowKey:"id",pagination:!1})})}function B({setSearchState:o,selected:t,setSelectedRowKeys:r}){const[a,n]=u.useState(""),l=C(),{message:p}=j.useApp(),{t:i}=h(),c=u.useRef(null),{mutate:d}=v({mutationFn:()=>S(t),onSuccess:()=>{r([]),l.invalidateQueries(x.campaign),p.success("Campaign deleted!")},onError:()=>{p.error("Campaign delete error!")}}),b=s=>{I.isEmpty(t)||(s.stopPropagation(),_().then(async g=>{g.isConfirmed&&d()}))},F=()=>{var g;const s=(g=c.current)==null?void 0:g.input;n((s==null?void 0:s.value)??""),o(N=>({...N,page:1,search:a}))};return e.jsxs(E,{className:"mt-6",children:[e.jsx(Q,{ref:c,className:"w-[350px]",placeholder:i("Search by campaign name"),value:a,onChange:s=>n(s.target.value),onPressEnter:F}),e.jsx(f,{label:i("Search"),type:"primary",active:!0,onClick:()=>o(s=>({...s,page:1,search:a}))}),t.length>0&&e.jsx(f,{onClick:b,label:`${i("Delete")} ${t.length} ${t.length>1?i("records"):i("record")}`,buttonMenu:!0,type:"error"})]})}const H=({searchState:o,setSearchState:t})=>{const{t:r}=h(),a=(...p)=>{const[i,c]=p;t(d=>({...d,page:i,limit:c}))},{data:n={}}=y({queryFn:()=>T(o),queryKey:[x.campaign,o],refetchOnMount:!0,refetchOnWindowFocus:!0}),{total:l=0}=n;return e.jsx(e.Fragment,{children:l>0&&e.jsx($,{size:"default",showTitle:!1,showQuickJumper:!0,pageSize:o.limit,current:o.page,pageSizeOptions:[10,20,50,100],total:l,onChange:a,showSizeChanger:!0,locale:{items_per_page:r("page"),jump_to:r("Go to"),page:r("Page")}})})},w=u.createContext(void 0);function Ie(){const[o,t]=u.useState({search:"",page:1,limit:10}),[r,a]=u.useState([]),n={searchState:o};return e.jsxs(w.Provider,{value:n,children:[e.jsxs("div",{className:"h-[calc(100vh-130px)] flex flex-col gap-[10px] overflow-hidden pr-4",children:[e.jsx(B,{selected:r,setSearchState:t,setSelectedRowKeys:a}),e.jsx(O,{searchState:o,selectedRowKeys:r,setSelectedRowKeys:a})]}),e.jsx("div",{className:"h-[64px] flex justify-end items-center px-2",children:e.jsx(H,{searchState:o,setSearchState:t})})]})}export{w as CampaignContext,Ie as default};
