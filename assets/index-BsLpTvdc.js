import{i as c,r as m,q as B,j as N,k as e,S as F}from"./index-CJvg638n.js";import{u as M}from"./useMutation-DtMNI5dJ.js";import{u as q}from"./useQuery-DJ-tefVM.js";import{B as y}from"./index-BAIjI0rE.js";import{D as C}from"./DeleteConfirmModal-CCC5Ho8A.js";import{Q as f}from"./queryKey.const-4yptRpGc.js";import{u as S}from"./theme-D5S-1fEx.js";import{F as a}from"./index-YCIRg4HO.js";import{u as E}from"./useTranslation-DN-CYzVf.js";import{f as I}from"./index-BlXw00gF.js";import{M as T}from"./index-Cn7Yo5Hv.js";import{I as g}from"./index-4M1x7pR3.js";const U=async(t=!0)=>{const{data:s}=await c.get("/v4/proxy-config/list-proxy-config-hide");return s},Q=async()=>{const{data:t}=await c.get("/v4/proxy-config/get-price-setting");return t},D=async({gb:t,name:s})=>{const{data:o}=await c.post("/v4/proxy-config/buy-proxy-config",{flow:t,name:s});return o},h=new RegExp("^(?:[1-4][0-9]{2}|[1-9][0-9]|[1-9])$"),$=()=>{var x,p;const[t]=a.useForm(),{t:s}=E(),[o,l]=m.useState(!1),{message:u}=B.useApp(),n=a.useWatch("gb",t),d=N(),j=S(),{data:i,isFetching:b}=q({queryFn:()=>Q(),queryKey:["getPriceHidemiumProxy"],refetchOnMount:!0}),{isLoading:H,mutate:w}=M({mutationFn:r=>D(r),onSuccess:({title:r})=>{u.success(r||"Success"),d.invalidateQueries(f.getListHidemiumProxy,{refetchInactive:!0}),d.invalidateQueries(f.userDetail),l(!1)},onError:r=>{u.error(r.message||"Error")}}),P=async()=>{if(!await t.validateFields().catch(()=>null))return;const{isConfirmed:v}=await C({title:s("Confirm Buy Hidemium Proxy")});v&&t.submit()};return m.useEffect(()=>{if(!h.test(n))return;const r=I(new Date,"yyyyMMddHHmmss");t.setFieldValue("name",`Hidemium_${n}GB_${r}`)},[n]),e.jsxs(e.Fragment,{children:[e.jsx(y,{label:s("Buy Hidemium Proxy"),typebutton:"warning",classStyle:"w-fit",solid:!0,onClick:()=>l(!0)}),e.jsx(T,{open:o,onCancel:()=>l(!1),centered:!0,title:e.jsx("div",{className:"text-[20px]",style:{color:j.titlePrimary},children:s("Buy Hidemium proxy")}),footer:null,zIndex:1e3,children:e.jsxs(F,{spinning:b||H,children:[e.jsxs(a,{onFinish:w,form:t,layout:"vertical",initialValues:{gb:5},children:[e.jsx(a.Item,{name:"gb",label:e.jsx("span",{className:"font-bold",children:s("Data plan (GB)")}),rules:[{required:!0,message:s("This field is required")},{pattern:h,message:"Invalid data number"}],children:e.jsx(g,{placeholder:"1 - 500",className:"w-full"})}),e.jsx(a.Item,{name:"name",label:e.jsx("span",{className:"font-bold",children:s("Proxy name")}),rules:[{required:!0,message:s("This field is required")},{max:50,message:"The name cannot be longer than 50 characters"}],children:e.jsx(g,{className:"w-full"})})]}),e.jsx("div",{children:e.jsxs("p",{className:"font-bold text-lg",children:[e.jsxs("span",{children:[s("Total cost: ")," "]}),e.jsxs("span",{className:"text-green-600",children:[(n||0)*(((x=i==null?void 0:i.content)==null?void 0:x.price)||0)," $"]}),e.jsx("span",{className:"ml-2",children:s("for")}),e.jsx("span",{className:"ml-1 text-green-600",children:(p=i==null?void 0:i.content)==null?void 0:p.date_expired}),e.jsx("span",{className:"ml-1",children:s("days")})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(y,{label:s("Buy now"),typebutton:"primary",classStyle:"w-fit",solid:!0,onClick:P})})]})})]})},X=m.memo($);export{X as B,U as g};
