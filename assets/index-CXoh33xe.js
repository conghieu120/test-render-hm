import{i as c,r as l,q as B,j as N,k as e,S as F}from"./index-rD5D3wIe.js";import{u as M}from"./useMutation-7pHNuXnK.js";import{u as q}from"./useQuery-DGelT77v.js";import{B as f}from"./index-Cnfr_LhE.js";import{D as C}from"./DeleteConfirmModal-DSBDXsxU.js";import{Q as y}from"./queryKey.const-4yptRpGc.js";import{u as E}from"./theme-CwYL3eQV.js";import{F as i}from"./index-D0qsI2Ko.js";import{u as I}from"./useTranslation-CdVDZguR.js";import{f as T}from"./index-B3nBNj8d.js";import{M as D}from"./index-DduQbOjH.js";import{I as g}from"./index-R7zUTNyO.js";const U=async(t=!0)=>{const{data:s}=await c.get("/v4/proxy-config/list-proxy-config-hide");return s},Q=async()=>{const{data:t}=await c.get("/v4/proxy-config/get-price-setting");return t},S=async({gb:t,name:s})=>{const{data:o}=await c.post("/v4/proxy-config/buy-proxy-config",{flow:t,name:s});return o},h=new RegExp("^(?:[1-4][0-9]{2}|[1-9][0-9]|[1-9])$"),$=()=>{var p,x;const[t]=i.useForm(),{t:s}=I(),[o,m]=l.useState(!1),{message:u}=B.useApp(),n=i.useWatch("gb",t),d=N(),j=E(),{data:a,isFetching:b}=q({queryFn:()=>Q(),queryKey:["getPriceHidemiumProxy"],refetchOnMount:!0}),{isLoading:H,mutate:v}=M({mutationFn:r=>S(r),onSuccess:({title:r})=>{u.success(r||"Success"),d.invalidateQueries(y.getListHidemiumProxy,{refetchInactive:!0}),d.invalidateQueries(y.userDetail),m(!1)},onError:r=>{u.error(r.message||"Error")}}),P=async()=>{if(!await t.validateFields().catch(()=>null))return;const{isConfirmed:w}=await C({title:s("Confirm Buy Hidemium Proxy")});w&&t.submit()};return l.useEffect(()=>{if(!h.test(n))return;const r=T(new Date,"yyyyMMddHHmmss");t.setFieldValue("name",`Hidemium_${n}GB_${r}`)},[n]),e.jsxs(e.Fragment,{children:[e.jsx(f,{label:s("Buy Hidemium Proxy"),type:"warning",onClick:r=>{r.preventDefault,m(!0)}}),e.jsx(D,{open:o,onCancel:()=>m(!1),centered:!0,title:e.jsx("div",{className:"text-[20px]",style:{color:j.titlePrimary},children:s("Buy Hidemium proxy")}),footer:null,zIndex:1e3,children:e.jsxs(F,{spinning:b||H,children:[e.jsxs(i,{onFinish:v,form:t,layout:"vertical",initialValues:{gb:5},children:[e.jsx(i.Item,{name:"gb",label:e.jsx("span",{className:"font-bold",children:s("Data plan (GB)")}),rules:[{required:!0,message:s("This field is required")},{pattern:h,message:"Invalid data number"}],children:e.jsx(g,{placeholder:"1 - 500",className:"w-full"})}),e.jsx(i.Item,{name:"name",label:e.jsx("span",{className:"font-bold",children:s("Proxy name")}),rules:[{required:!0,message:s("This field is required")},{max:50,message:"The name cannot be longer than 50 characters"}],children:e.jsx(g,{className:"w-full"})})]}),e.jsx("div",{children:e.jsxs("p",{className:"font-bold text-lg",children:[e.jsxs("span",{children:[s("Total cost: ")," "]}),e.jsxs("span",{className:"text-green-600",children:[(n||0)*(((p=a==null?void 0:a.content)==null?void 0:p.price)||0)," $"]}),e.jsx("span",{className:"ml-2",children:s("for")}),e.jsx("span",{className:"ml-1 text-green-600",children:(x=a==null?void 0:a.content)==null?void 0:x.date_expired}),e.jsx("span",{className:"ml-1",children:s("days")})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(f,{label:s("Buy now"),type:"primary",solid:!0,onClick:P})})]})})]})},X=l.memo($);export{X as B,U as g};
