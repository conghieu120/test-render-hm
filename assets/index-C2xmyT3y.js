import{i as T,fM as Y,fN as J,fO as X,fP as Z,fQ as ee,r as i,p as te,H as se,j as ne,k as e,P as ae,L as oe,w as _,O as R,N as re}from"./index-rD5D3wIe.js";import{f as H}from"./commonHelpers-BOkgPZYN.js";import{I as K,a as ce,b as le}from"./coinbase-commerce-button-kLEPgP0X.js";import{u as Q}from"./useQuery-DGelT77v.js";import{Q as F}from"./queryKey.const-4yptRpGc.js";import{g as ie}from"./paymentService-fBVNx2X5.js";import{e as de}from"./index.esm-By9H6xJu.js";import{b as pe}from"./index.esm-CuvWRocu.js";import{u as me}from"./theme-CwYL3eQV.js";import{u as S}from"./useTranslation-CdVDZguR.js";import{R as N,C as m}from"./row-D9yJnvb0.js";import{I as O}from"./index-BMo3QHL0.js";import{T as I}from"./index-WqkPP-4X.js";import{B as $}from"./index-Cnfr_LhE.js";import{M as xe}from"./index-DduQbOjH.js";import{u as ue}from"./useMutation-7pHNuXnK.js";import{F as L}from"./index-D0qsI2Ko.js";import{s as he}from"./index-BqcLO0q9.js";import{I as fe}from"./index-Bn6pjTd0.js";import{g as ye}from"./auth-D6OQT4bj.js";import"./commonjsHelpers__-BosuxZz1.js";import"./utils-Dji2qSVF.js";import"./responsiveObserver-CoLEQsUO.js";import"./EyeOutlined-D2K23cwb.js";import"./addEventListener-Dnrwfmdl.js";import"./LeftOutlined-hwnj7f46.js";import"./index-VaFpLiuL.js";import"./index-BUNugdcr.js";import"./TextArea-D8GM8mUo.js";import"./CheckOutlined-CxcD5R4P.js";import"./PurePanel-CzAY4fQy.js";import"./collapse-C1MjllT7.js";import"./DownOutlined-U_yyBD4s.js";const A=async n=>await T.post(Y,n),je=async n=>await T.post(X,n),be=async n=>await T.post(Z,n),ke=async n=>await T.post(ee,n),Ne=async n=>await T.post(J,n),B=346511,W={id:0,user_id:0,email:"",payment_method_id:0,amount:0,amount_vn:0,currency:"",note:"",status:0},w=i.createContext({cardActive:"bank",setCardActive:n=>{},userDetails:{},setUserDetails:n=>{},listPaymentMethod:[],setListPaymentMethod:n=>{},amount:10,setAmount:n=>{},depositItem:W,setDepositItem:n=>{},getPingDeposit:()=>{},clearPingDeposit:()=>{}});function ge({children:n}){const[o,x]=i.useState("bank"),[r,c]=i.useState(),[h,l]=i.useState(),[u,p]=i.useState(10),[a,g]=i.useState(W),y=te(),b=se(),j=ne(),t=i.useRef([]),d=()=>{if(a!=null&&a.id){s();const P=setInterval(()=>{const M={deposit_id:(a==null?void 0:a.id)*B};Ne(M).then(E=>{clearInterval(P),y(ae.profiles),b(oe(!0)),j.invalidateQueries(F.userDetail,{refetchInactive:!0})})},3e3);console.log("check deposit",P),t.current.push(P)}},s=()=>{console.log("clear check deposit",t),t.current.forEach(P=>clearInterval(P)),t.current=[]};i.useEffect(()=>{a.id!=0&&(o=="bank"||o=="crypto"||o=="paypal")?d():s()},[a]),i.useEffect(()=>()=>{s()},[]);const f={cardActive:o,setCardActive:x,userDetails:r,setUserDetails:c,listPaymentMethod:h,setListPaymentMethod:l,amount:u,setAmount:p,depositItem:a,setDepositItem:g,getPingDeposit:d,clearPingDeposit:s};return e.jsx(w.Provider,{value:f,children:n})}const G={"background-balance":"_background-balance_ed293_1","card-active":"_card-active_ed293_39"};function Ce({listCardPay:n,setCardActive:o,cardActive:x}){const r=me(),{token:{textGray:c,textWhite:h}}=_.useToken(),{Text:l}=I,{t:u}=S();return e.jsxs("div",{className:"pr-12",children:[e.jsxs(l,{className:"text-[20px] font-bold block",children:["1.",u("Select your subscription method")]}),e.jsx("div",{className:"mt-3.5",children:n.map((p,a)=>e.jsx("div",{style:{boxShadow:"0px 0px 4px 2px rgb(0,0,0,0.15)",borderRadius:"5px",minHeight:90,backgroundColor:x!=p.key?r.backgroundNormal:""},className:`w-full cursor-pointer px-5 py-3 my-5 ${x===p.key?G["card-active"]:""}`,onClick:()=>o(p.key),children:e.jsxs(N,{children:[e.jsx(m,{span:1,children:e.jsx("div",{className:"",children:x===p.key?e.jsx(de,{className:"text-xl",color:h}):e.jsx(pe,{className:"text-xl",color:c})})}),e.jsx(m,{span:15,children:e.jsx(l,{className:`ml-2 text-[14px] ${x===p.key?`text-[${h}]`:""}`,children:p.key=="bank"?u("Bạn có thể chuyển khoản trực tiếp qua ngân hàng ACB Bank"):p.key=="paypal"?u("Use paypal method to purchase, card payment will be support here"):p.key=="crypto"?u("You can purchase via crytor, use usdt or other coin"):""})}),e.jsx(m,{span:8,children:e.jsxs("div",{className:"text-right",children:[e.jsx(l,{className:`font-bold mt-0 mb-2 text-[16px] block ${x===p.key?`text-[${h}]`:""}`,children:p.title}),e.jsx("div",{children:p.listImg&&p.listImg.map((g,y)=>e.jsx(O,{preview:!1,className:"pr-1",src:g,style:{width:35}},y))})]})})]})},a))})]})}function Pe({isModelOpen:n,setIsModelOpen:o}){var U,q;const{Title:x,Text:r}=I,{token:{textPrimary:c,bgLineGray:h,colorLineGray:l,buttonPrimary:u,textWhite:p}}=_.useToken(),[a,g]=i.useState(),[y,b]=i.useState("ACB"),j=i.useRef(),[t,d]=i.useState(),{listPaymentMethod:s,depositItem:f}=i.useContext(w),P=[{key:"ACB",bank:"ACB",img:K,isDisabled:!1}],M=k=>{b(k)},E=()=>{o(!1)},z=()=>{const k=s==null?void 0:s.find(C=>{if(C.method=="bank"&&C.name==y)return C});g(k),j.current=k,V()},V=()=>{var C;const k={deposit_id:(f==null?void 0:f.id)*B,payment_method_id:((C=j.current)==null?void 0:C.id)*B};je(k).then(v=>{var D;d((D=v==null?void 0:v.data)==null?void 0:D.content)}).catch(v=>{console.log("error handleBankCheckout",v)})};return i.useEffect(()=>{f.id&&z()},[n]),e.jsxs(xe,{title:e.jsx(x,{style:{fontSize:"24px",color:c},children:"Instant bank transfer"}),open:n,onCancel:E,width:800,maskClosable:!1,footer:[e.jsx($,{label:R("Close"),type:"primary",onClick:E},1)],children:[e.jsxs(N,{className:"mt-7",children:[e.jsx(m,{span:8,children:e.jsx("div",{className:"w-full py-5",style:{backgroundColor:h},children:e.jsx("div",{className:"w-[200px] m-auto",children:e.jsx(O,{className:"rounded-[10px]",preview:!1,src:`https://img.vietqr.io/image/ACB-${(U=a==null?void 0:a.info)==null?void 0:U.account_number}-compact.png?amount=${t==null?void 0:t.amount_vn}&addInfo=${t==null?void 0:t.transaction}&accountName=${(q=a==null?void 0:a.info)==null?void 0:q.branch_name}`})})})}),e.jsxs(m,{span:16,className:"px-10",children:[e.jsxs(N,{children:[e.jsx(m,{span:24,children:e.jsx(r,{className:"text-[14px] font-semibold",children:"Select a payment method"})}),e.jsx(m,{span:24,children:e.jsx("div",{className:"flex my-3",children:P.map((k,C)=>e.jsx("div",{onClick:()=>M(k.key),style:{border:y==k.key?`1px solid ${c}`:"1px solid #BFBFBF"},className:"px-7 py-1 rounded-[4px]  border-solid flex items-center mr-3",children:e.jsx(O,{preview:!1,className:"pr-1",src:k.img,width:35})},C))})})]}),P.map((k,C)=>{var v,D;if(k.key==y)return e.jsxs(N,{children:[e.jsx(m,{span:24,children:e.jsxs("div",{style:{borderBottom:`1px dotted ${l}`},className:"py-1",children:[e.jsx(r,{className:"text-[16px] font-normal",children:"Bank : "}),e.jsx(r,{className:`font-bold text-[16px] text-[${c}]`,children:k.bank})]})}),e.jsx(m,{span:24,children:e.jsxs("div",{style:{borderBottom:`1px dotted ${l}`},className:"py-1",children:[e.jsx(r,{className:"text-[16px] font-normal",children:"Account Holder : "}),e.jsx(r,{className:`font-bold text-[16px] text-[${c}]`,children:(v=a==null?void 0:a.info)==null?void 0:v.branch_name})]})}),e.jsx(m,{span:24,children:e.jsxs("div",{style:{borderBottom:`1px dotted ${l}`},className:"py-1",children:[e.jsx(r,{className:"text-[16px] font-normal",children:"Account Number : "}),e.jsx(r,{className:`font-bold text-[16px] text-[${c}]`,children:(D=a==null?void 0:a.info)==null?void 0:D.account_number})]})}),e.jsx(m,{span:24,children:e.jsxs("div",{style:{borderBottom:`1px dotted ${l}`},className:"py-1",children:[e.jsx(r,{className:"text-[16px] font-normal",children:"Total Price : "}),e.jsxs(r,{className:`font-bold text-[16px] text-[${c}]`,children:[H({price:t==null?void 0:t.amount_vn,maximumFractionDigits:0,style:"decimal"}),e.jsx("span",{children:" VND"})]})]})}),e.jsx(m,{span:24,children:e.jsxs("div",{style:{borderBottom:`1px dotted ${l}`},className:"py-1",children:[e.jsx(r,{className:"text-[16px] font-normal",children:"Transfer Content : "}),e.jsx(r,{className:`font-bold text-[16px] text-[${c}]`,children:t==null?void 0:t.transaction})]})})]},C)})]})]}),e.jsx(N,{children:e.jsx(m,{span:24,children:e.jsx("div",{style:{borderTop:`1px dashed ${l}`,borderBottom:`1px dashed ${l}`},className:"mt-5",children:e.jsxs("ul",{children:[e.jsx("li",{children:"Please double check if the address is correct before payment"}),e.jsx("li",{children:"Please double check if the address is correct before payment"}),e.jsx("li",{children:"Please double check if the address is correct before payment"})]})})})})]})}function ve({cardActive:n}){var y;const o=i.useRef(),{listPaymentMethod:x,amount:r,setDepositItem:c,depositItem:h}=i.useContext(w),[l,u]=i.useState(),p=(b=h.id*B)=>{var t;u(!0);const j={payment_method_id:((t=o.current)==null?void 0:t.id)*B,deposit_id:b};be(j).then(d=>{var s,f;u(!1),window.api.openLinkWebBrowser((f=(s=d==null?void 0:d.data)==null?void 0:s.content)==null?void 0:f.redirect_url)}).catch(d=>{u(!1),console.log("error handleCoinBaseCheckout",d)})},a=()=>{const b=x.find(t=>{if(t.method=="crypto")return t});o.current=b;const j={amount:Number(r)};A(j).then(t=>{var d;c((d=t==null?void 0:t.data)==null?void 0:d.content)})};i.useEffect(()=>{n=="crypto"&&a()},[n,r]);const g=()=>{p()};return e.jsx(e.Fragment,{children:((y=o.current)==null?void 0:y.id)!=null&&e.jsx($,{type:"normal",onClick:g,active:!0,className:"w-full border-none rounded py-1 my-7 font-bold",size:"large",loading:l,label:R("Pay with Crypto")})})}function Be({cardActive:n}){var y;const o=i.useRef(),{listPaymentMethod:x,amount:r,setDepositItem:c,depositItem:h}=i.useContext(w),[l,u]=i.useState(),p=(b=h.id*B)=>{var t;u(!0);const j={payment_method_id:((t=o.current)==null?void 0:t.id)*B,deposit_id:b};ke(j).then(d=>{var s,f;u(!1),window.api.openLinkWebBrowser((f=(s=d==null?void 0:d.data)==null?void 0:s.content)==null?void 0:f.redirect_url)}).catch(d=>{u(!1),console.log("error handlePaypalCheckout",d)})},a=()=>{const b=x.find(t=>{if(t.method=="paypal")return t});o.current=b;const j={amount:Number(r)};A(j).then(t=>{var d;c((d=t==null?void 0:t.data)==null?void 0:d.content)})};i.useEffect(()=>{n=="paypal"&&a()},[n,r]);const g=()=>{p()};return e.jsx(e.Fragment,{children:((y=o.current)==null?void 0:y.id)!=null&&e.jsx($,{onClick:g,type:"normal",className:"w-full border-none rounded py-1 my-7 font-bold",size:"large",loading:l,label:R("Pay with Paypal")})})}function we({cardActive:n}){const{Text:o}=I,{token:{textPrimary:x}}=_.useToken(),{amount:r,setAmount:c,setDepositItem:h}=i.useContext(w),[l,u]=i.useState(),[p]=L.useForm(),{t:a}=S(),g=()=>{p.submit()},y=s=>{s&&Number(s)>0&&c(s)},b=s=>{c(s),p.setFieldValue("amount",s)},j=[10,25,50,75,100,200],{mutate:t,isLoading:d}=ue({mutationFn:s=>A(s),onError:s=>{he.error("Error send token")},onSuccess:s=>{var f;switch(h((f=s==null?void 0:s.data)==null?void 0:f.content),n){case"bank":u(!0);break;default:u(!1);break}}});return e.jsxs("div",{className:"pl-12",children:[e.jsxs(o,{className:"font-bold text-[20px]",children:["2.",a("Deposit amount")]}),e.jsx(N,{className:"my-5",children:e.jsx(m,{span:24,children:e.jsx(L,{className:" flex space-x-5",form:p,onFinish:t,initialValues:{amount:r},onValuesChange:(s,f)=>y(s==null?void 0:s.amount),children:e.jsx(L.Item,{name:"amount",className:"w-full m-0",rules:[{required:!0,type:"number",min:1}],children:e.jsx(fe,{className:"w-full",parser:s=>s.replace(/[^\d]/g,""),formatter:s=>`${s}`.replace(/[^\d]/g,"")})})})})}),e.jsx(N,{children:e.jsx(m,{span:24,className:"flex justify-between",children:j.map((s,f)=>e.jsx("div",{children:e.jsx(re,{className:"capitalize",style:{minWidth:"80px"},onClick:()=>b(s),children:`$ ${s}`})},f))})}),e.jsx(N,{children:e.jsxs(m,{span:24,className:"text-center",children:[n=="bank"&&e.jsx($,{className:"w-full mt-8 mb-5",onClick:g,loading:d,label:a("Pay now"),type:"normal"}),n=="paypal"&&e.jsx(Be,{cardActive:n}),n=="crypto"&&e.jsx(ve,{cardActive:n})]})}),e.jsx(N,{children:e.jsxs(m,{span:24,children:[e.jsx(o,{className:`font-bold text-[20px] text-[${x}] block mb-2`,children:a("Note")}),e.jsxs(o,{className:"text-[14px] block mb-2",children:["1. ",a("This address is only for accepting USDT(TRC20). If you send other coins to this address, they cannot be reversed, and no compension will be made.")]}),e.jsxs(o,{className:"text-[14px] block",children:["2. ",a("This address is only for accepting USDT(TRC20). If you send other coins to this address, they cannot be reversed, and no compension will be made.")]})]})}),e.jsx(Pe,{isModelOpen:l,setIsModelOpen:u})]})}function De(){const{token:{colorLineGray:n}}=_.useToken(),{cardActive:o,setCardActive:x,setListPaymentMethod:r}=i.useContext(w),{t:c}=S(),h=[{key:"bank",title:c("Instant Bank Transfer"),listImg:[K],isDisabled:!1},{key:"paypal",title:c("Paypal"),listImg:[ce],isDisabled:!1},{key:"crypto",title:c("Coin Base"),listImg:[le],isDisabled:!1}];return Q({queryFn:()=>ie(),queryKey:F.listPaymentMethod,onSuccess:async l=>{var u;r((u=l==null?void 0:l.data)==null?void 0:u.content)},refetchOnMount:!0}),e.jsxs(N,{children:[e.jsx(m,{span:12,style:{borderRight:`2px solid ${n}`},children:e.jsx(Ce,{listCardPay:h,setCardActive:x,cardActive:o})}),e.jsx(m,{span:12,children:e.jsx(we,{cardActive:o})})]})}function lt(){var h,l;const{token:{textPrimary:n,textWhite:o}}=_.useToken(),{Text:x}=I,{data:r}=Q({queryFn:()=>ye(),queryKey:F.userDetail,refetchOnMount:!0}),{t:c}=S();return e.jsx(ge,{children:e.jsxs(N,{className:"pr-12 pl-7",children:[e.jsx(m,{span:24,children:e.jsx("div",{className:`w-full rounded p-7 my-9 ${G["background-balance"]}`,children:e.jsxs(N,{children:[e.jsxs(m,{span:17,children:[e.jsx(x,{className:`text-[16px] font-bold block text-[${o}]`,children:c("Account information")}),e.jsx(x,{className:`text-[32px] block font-bold text-[${o}]`,children:c("BALANCE")})]}),e.jsxs(m,{span:7,className:"relative",children:[e.jsxs(x,{className:`text-[16px] mr-7 text-[${o}]`,children:[c("Total"),":"]}),e.jsx(x,{className:`text-[50px] font-bold text-[${o}]`,children:H({price:((l=(h=r==null?void 0:r.data)==null?void 0:h.content)==null?void 0:l.balance)??0,maximumFractionDigits:2})})]})]})})}),e.jsx(m,{span:24,children:e.jsx(De,{})})]})})}export{lt as default};
