import{r as c,q as y,j as N,k as e,O as h,S as b}from"./index-rD5D3wIe.js";import{g as T,B as v}from"./index-CXoh33xe.js";import{u as P}from"./useMutation-7pHNuXnK.js";import{u as S}from"./proxyService-BvUDuHG4.js";import{Q as g}from"./queryKey.const-4yptRpGc.js";import{u}from"./theme-CwYL3eQV.js";import{F as p}from"./index-D0qsI2Ko.js";import{I as F}from"./index-R7zUTNyO.js";import{u as x}from"./useTranslation-CdVDZguR.js";import{T as H}from"./Table-CkCjhjFV.js";import{u as _}from"./useQuery-DGelT77v.js";import{T as C}from"./index-CwHt7GoT.js";import{S as E}from"./index-u5E2RjuN.js";import{P as w}from"./Pagination-Du9klKsI.js";import"./commonjsHelpers-BosuxZz1.js";import"./index-Cnfr_LhE.js";import"./DeleteConfirmModal-DSBDXsxU.js";import"./index-bFDahTXa.js";import"./index-B3nBNj8d.js";import"./index-DQqevswW.js";import"./index-DduQbOjH.js";import"./PurePanel-CzAY4fQy.js";import"./utils-Dji2qSVF.js";import"./collapse-C1MjllT7.js";import"./row-D9yJnvb0.js";import"./responsiveObserver-CoLEQsUO.js";import"./index-BUNugdcr.js";import"./index-VaFpLiuL.js";import"./TextArea-D8GM8mUo.js";import"./EyeOutlined-D2K23cwb.js";import"./SearchOutlined-DPpNmpde.js";import"./index-WqkPP-4X.js";import"./CheckOutlined-CxcD5R4P.js";import"./addEventListener-Dnrwfmdl.js";import"./index-Cw8dqNCZ.js";import"./Overflow-wzPxOxK8.js";import"./DownOutlined-U_yyBD4s.js";import"./index-C97G-hLo.js";import"./index-c2ufQ9kY.js";import"./LeftOutlined-hwnj7f46.js";import"./Dropdown-BA274VvY.js";import"./extendsObject-BTpHJDoQ.js";import"./EllipsisOutlined-Cvv2ECO7.js";import"./index-DEeuvegC.js";import"./gapSize-U1swVQyS.js";import"./index-Rll6gE4e.js";function I({item:s}){const{message:i}=y.useApp(),r=u(),d=N(),[m]=p.useForm(),[t,n]=c.useState(!1),{mutate:o}=P({mutationFn:async()=>{const a=await m.validateFields().catch(()=>null);return!a||!(a!=null&&a.name)?Promise.reject({response:{data:"The name invalid!"}}):S(s.id,{name:m.getFieldValue("name").trim(),id:s.id,proxy_type:"hidemium_proxy",proxy_config:{...s}})},onSuccess:()=>{d.invalidateQueries(g.getListHidemiumProxy),i.success("Success"),n(!1)},onError:a=>{var l;i.error(((l=a==null?void 0:a.response)==null?void 0:l.data)||"Error"),n(!1)}});return e.jsx(e.Fragment,{children:t?e.jsx(p,{form:m,children:e.jsx(p.Item,{name:"name",className:"m-0",rules:[{required:!0,message:h("This field is required")},{max:50,message:"The name cannot be longer than 50 characters"}],children:e.jsx(F,{autoFocus:!0,className:"py-0 px-2 ml-1",onBlur:()=>{m.getFieldValue("name")!==s.name?o():n(!1)}})})}):e.jsx(e.Fragment,{children:s.is_expired?e.jsxs("span",{className:"text-red-600",onClick:()=>{m.setFieldValue("name",s.name),n(!0)},children:[s.name," (",h("Expired"),")"]}):e.jsx("span",{style:{color:r.textNormal},onClick:()=>{m.setFieldValue("name",s.name),n(!0)},children:s.name})})})}const f=c.memo(I),k=({data:s})=>{const{t:i}=x(),r=u();return e.jsx("div",{className:"p-2 col-span-1 h-fit",children:e.jsxs("div",{style:{borderColor:r.borderNormal,backgroundColor:s.is_expired?"#FEE2E1":r.backgroundLight,color:s.is_expired?"#333":r.textNormal},className:"p-4 rounded-xl cursor-pointer border-[.5px] border-solid ",children:[e.jsxs("p",{className:"flex items-center truncate ...",children:[e.jsxs("span",{className:"font-bold",children:[i("Name"),": "]}),e.jsx(f,{item:s})]}),e.jsxs("p",{children:[e.jsxs("span",{className:"font-bold",children:[i("Expired time"),": "]}),e.jsx("span",{className:"",children:s.expired_at})]}),e.jsx("p",{children:e.jsxs("span",{className:"font-bold",children:[i("Data"),":"]})})]})})},q=c.memo(k),Q=({data:s=[],loading:i})=>{const{t:r}=x(),d=u();return e.jsx("div",{style:{borderColor:d.borderNormal,backgroundColor:d.backgroundLight},className:"h-[calc(100vh-190px)] mr-5 rounded shadow-sm border-[.5px] border-solid overflow-auto",children:e.jsx(H,{loading:i,columns:[{title:r("No.STT"),render:(m,t,n)=>n+1,width:120,align:"center"},{title:r("Name"),dataIndex:"name",render:(m,t)=>e.jsx(f,{item:t})},{title:r("Data"),dataIndex:"data"},{title:r("Expired time"),dataIndex:"expired_at"}],dataSource:s,pagination:!1})})},L=c.memo(Q);function V(){const{t:s}=x(),[i,r]=c.useState("Table"),[d,m]=c.useState([]),[t,n]=c.useState({page:1,limit:10}),{data:o,isFetching:a}=_({queryFn:()=>T(),queryKey:[g.getListHidemiumProxy]});return c.useEffect(()=>{const l=((o==null?void 0:o.content)||[]).slice((t.page-1)*t.limit,t.page*t.limit);m(l)},[t,o]),e.jsxs("div",{className:"h-full overflow-hidden",children:[e.jsxs("div",{className:"mb-4 mt-2 flex items-center",children:[e.jsx(E,{options:[{label:s("Table"),value:"Table"},{label:s("Cards"),value:"Cards"}],className:"mr-4",value:i,onChange:r}),e.jsx(v,{})]}),e.jsx("div",{children:i==="Table"?e.jsx(L,{loading:a,data:d}):e.jsx(b,{spinning:a,children:e.jsx("div",{className:"overflow-y-scroll h-[calc(100vh-190px)]",children:e.jsx("div",{className:"grid grid-cols-2 xl:grid-cols-5",children:d.map(l=>e.jsx(q,{data:l},l.name))})})})}),e.jsxs("div",{className:"w-full h-[64px] p-4 gap-x-2 flex items-center justify-end",children:[e.jsx("div",{className:"",children:e.jsx(C,{className:"!text-[16px]",label:`Total: ${(o==null?void 0:o.content.length)||0}`})}),e.jsx(w,{showTitle:!1,showQuickJumper:!0,pageSize:t.limit,current:t.page,pageSizeOptions:[5,10,15,50],total:(o==null?void 0:o.content.length)||0,onChange:(l,j)=>n({page:l,limit:j}),showSizeChanger:!0,locale:{page:s("Page"),items_per_page:s("page"),jump_to:s("Go to")}})]})]})}const Ee=c.memo(V);export{Ee as default};
