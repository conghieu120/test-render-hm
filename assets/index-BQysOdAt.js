import{i as $,fM as V,fN as Y,fO as J,fP as X,fQ as Z,r as i,p as ee,H as te,j as se,k as e,P as ne,L as ae,w as D,N as S}from"./index-CJvg638n.js";import{f as U}from"./commonHelpers-BOkgPZYN.js";import{I as H,a as oe,b as re}from"./coinbase-commerce-button-kLEPgP0X.js";import{u as W}from"./useQuery-DJ-tefVM.js";import{Q as R}from"./queryKey.const-4yptRpGc.js";import{g as ce}from"./paymentService-vo3yCK6S.js";import{e as le}from"./index.esm-mlJjdzQr.js";import{b as ie}from"./index.esm-LNwInclH.js";import{u as de}from"./theme-D5S-1fEx.js";import{u as I}from"./useTranslation-DN-CYzVf.js";import{R as N,C as x}from"./row-C7cWNtLw.js";import{I as L}from"./index-DYrGpNsa.js";import{T as M}from"./index-D8gngLx0.js";import{M as pe}from"./index-Cn7Yo5Hv.js";import{u as me}from"./useMutation-DtMNI5dJ.js";import{F}from"./index-YCIRg4HO.js";import{s as xe}from"./index-DXD2j7QG.js";import{I as ue}from"./index-d2P14GTx.js";import{g as he}from"./auth-8cqRmsX-.js";import"./__commonjsHelpers__-BosuxZz1.js";import"./utils-Dji2qSVF.js";import"./responsiveObserver-BQm3ddGk.js";import"./EyeOutlined-B-Yk7nA6.js";import"./addEventListener-0hYE1V1V.js";import"./LeftOutlined-_e4uGCQm.js";import"./index-DC1DAWbZ.js";import"./index-BtoCM6cC.js";import"./TextArea-DBRPcsh0.js";import"./CheckOutlined-CxiWyKpb.js";import"./PurePanel-BiIzqeBG.js";import"./collapse-C1MjllT7.js";import"./DownOutlined-BgG6dx4I.js";const O=async n=>await $.post(V,n),fe=async n=>await $.post(J,n),ye=async n=>await $.post(X,n),je=async n=>await $.post(Z,n),be=async n=>await $.post(Y,n),T=346511,K={id:0,user_id:0,email:"",payment_method_id:0,amount:0,amount_vn:0,currency:"",note:"",status:0},w=i.createContext({cardActive:"bank",setCardActive:n=>{},userDetails:{},setUserDetails:n=>{},listPaymentMethod:[],setListPaymentMethod:n=>{},amount:10,setAmount:n=>{},depositItem:K,setDepositItem:n=>{},getPingDeposit:()=>{},clearPingDeposit:()=>{}});function ke({children:n}){const[d,m]=i.useState("bank"),[a,c]=i.useState(),[u,l]=i.useState(),[h,p]=i.useState(10),[s,g]=i.useState(K),j=ee(),P=te(),k=se(),r=i.useRef([]),f=()=>{if(s!=null&&s.id){t();const y=setInterval(()=>{const v={deposit_id:(s==null?void 0:s.id)*T};be(v).then(E=>{clearInterval(y),j(ne.profiles),P(ae(!0)),k.invalidateQueries(R.userDetail,{refetchInactive:!0})})},3e3);console.log("check deposit",y),r.current.push(y)}},t=()=>{console.log("clear check deposit",r),r.current.forEach(y=>clearInterval(y)),r.current=[]};i.useEffect(()=>{s.id!=0&&(d=="bank"||d=="crypto"||d=="paypal")?f():t()},[s]),i.useEffect(()=>()=>{t()},[]);const o={cardActive:d,setCardActive:m,userDetails:a,setUserDetails:c,listPaymentMethod:u,setListPaymentMethod:l,amount:h,setAmount:p,depositItem:s,setDepositItem:g,getPingDeposit:f,clearPingDeposit:t};return e.jsx(w.Provider,{value:o,children:n})}const Q={"background-balance":"_background-balance_sqq88_1","card-active":"_card-active_sqq88_15"};function Ne({listCardPay:n,setCardActive:d,cardActive:m}){const a=de(),{token:{textGray:c,textWhite:u}}=D.useToken(),{Text:l}=M,{t:h}=I();return e.jsxs("div",{className:"pr-12",children:[e.jsxs(l,{className:"text-[20px] font-bold block",children:["1.",h("Select your subscription method")]}),e.jsx("div",{className:"mt-3.5",children:n.map((p,s)=>e.jsx("div",{style:{boxShadow:"0px 0px 4px 2px rgb(0,0,0,0.15)",borderRadius:"5px",minHeight:90,backgroundColor:m!=p.key?a.backgroundNormal:""},className:`w-full cursor-pointer px-5 py-3 my-5 ${m===p.key?Q["card-active"]:""}`,onClick:()=>d(p.key),children:e.jsxs(N,{children:[e.jsx(x,{span:1,children:e.jsx("div",{className:"",children:m===p.key?e.jsx(le,{className:"text-xl",color:u}):e.jsx(ie,{className:"text-xl",color:c})})}),e.jsx(x,{span:15,children:e.jsx(l,{className:`ml-2 text-[14px] ${m===p.key?`text-[${u}]`:""}`,children:p.key=="bank"?h("Bạn có thể chuyển khoản trực tiếp qua ngân hàng ACB Bank"):p.key=="paypal"?h("Use paypal method to purchase, card payment will be support here"):p.key=="crypto"?h("You can purchase via crytor, use usdt or other coin"):""})}),e.jsx(x,{span:8,children:e.jsxs("div",{className:"text-right",children:[e.jsx(l,{className:`font-bold mt-0 mb-2 text-[16px] block ${m===p.key?`text-[${u}]`:""}`,children:p.title}),e.jsx("div",{children:p.listImg&&p.listImg.map((g,j)=>e.jsx(L,{preview:!1,className:"pr-1",src:g,style:{width:35}},j))})]})})]})},s))})]})}function ge({isModelOpen:n,setIsModelOpen:d}){var q,A;const{Title:m,Text:a}=M,{token:{textPrimary:c,bgLineGray:u,colorLineGray:l,buttonPrimary:h,textWhite:p}}=D.useToken(),[s,g]=i.useState(),[j,P]=i.useState("ACB"),k=i.useRef(),[r,f]=i.useState(),{listPaymentMethod:t,depositItem:o}=i.useContext(w),y=[{key:"ACB",bank:"ACB",img:H,isDisabled:!1}],v=b=>{P(b)},E=()=>{d(!1)},z=()=>{const b=t==null?void 0:t.find(C=>{if(C.method=="bank"&&C.name==j)return C});g(b),k.current=b,G()},G=()=>{var C;const b={deposit_id:(o==null?void 0:o.id)*T,payment_method_id:((C=k.current)==null?void 0:C.id)*T};fe(b).then(B=>{var _;f((_=B==null?void 0:B.data)==null?void 0:_.content)}).catch(B=>{console.log("error handleBankCheckout",B)})};return i.useEffect(()=>{o.id&&z()},[n]),e.jsxs(pe,{title:e.jsx(m,{style:{fontSize:"24px",color:c},children:"Instant bank transfer"}),open:n,onCancel:E,width:800,maskClosable:!1,footer:[e.jsx(S,{type:"primary",className:`h-[30] text-[${p}] text-[14px] bg-[${h}]`,onClick:E,children:"Close"},1)],children:[e.jsxs(N,{className:"mt-7",children:[e.jsx(x,{span:8,children:e.jsx("div",{className:"w-full py-5",style:{backgroundColor:u},children:e.jsx("div",{className:"w-[200px] m-auto",children:e.jsx(L,{className:"rounded-[10px]",preview:!1,src:`https://img.vietqr.io/image/ACB-${(q=s==null?void 0:s.info)==null?void 0:q.account_number}-compact.png?amount=${r==null?void 0:r.amount_vn}&addInfo=${r==null?void 0:r.transaction}&accountName=${(A=s==null?void 0:s.info)==null?void 0:A.branch_name}`})})})}),e.jsxs(x,{span:16,className:"px-10",children:[e.jsxs(N,{children:[e.jsx(x,{span:24,children:e.jsx(a,{className:"text-[14px] font-semibold",children:"Select a payment method"})}),e.jsx(x,{span:24,children:e.jsx("div",{className:"flex my-3",children:y.map((b,C)=>e.jsx("div",{onClick:()=>v(b.key),style:{border:j==b.key?`1px solid ${c}`:"1px solid #BFBFBF"},className:"px-7 py-1 rounded-[4px]  border-solid flex items-center mr-3",children:e.jsx(L,{preview:!1,className:"pr-1",src:b.img,width:35})},C))})})]}),y.map((b,C)=>{var B,_;if(b.key==j)return e.jsxs(N,{children:[e.jsx(x,{span:24,children:e.jsxs("div",{style:{borderBottom:`1px dotted ${l}`},className:"py-1",children:[e.jsx(a,{className:"text-[16px] font-normal",children:"Bank : "}),e.jsx(a,{className:`font-bold text-[16px] text-[${c}]`,children:b.bank})]})}),e.jsx(x,{span:24,children:e.jsxs("div",{style:{borderBottom:`1px dotted ${l}`},className:"py-1",children:[e.jsx(a,{className:"text-[16px] font-normal",children:"Account Holder : "}),e.jsx(a,{className:`font-bold text-[16px] text-[${c}]`,children:(B=s==null?void 0:s.info)==null?void 0:B.branch_name})]})}),e.jsx(x,{span:24,children:e.jsxs("div",{style:{borderBottom:`1px dotted ${l}`},className:"py-1",children:[e.jsx(a,{className:"text-[16px] font-normal",children:"Account Number : "}),e.jsx(a,{className:`font-bold text-[16px] text-[${c}]`,children:(_=s==null?void 0:s.info)==null?void 0:_.account_number})]})}),e.jsx(x,{span:24,children:e.jsxs("div",{style:{borderBottom:`1px dotted ${l}`},className:"py-1",children:[e.jsx(a,{className:"text-[16px] font-normal",children:"Total Price : "}),e.jsxs(a,{className:`font-bold text-[16px] text-[${c}]`,children:[U({price:r==null?void 0:r.amount_vn,maximumFractionDigits:0,style:"decimal"}),e.jsx("span",{children:" VND"})]})]})}),e.jsx(x,{span:24,children:e.jsxs("div",{style:{borderBottom:`1px dotted ${l}`},className:"py-1",children:[e.jsx(a,{className:"text-[16px] font-normal",children:"Transfer Content : "}),e.jsx(a,{className:`font-bold text-[16px] text-[${c}]`,children:r==null?void 0:r.transaction})]})})]},C)})]})]}),e.jsx(N,{children:e.jsx(x,{span:24,children:e.jsx("div",{style:{borderTop:`1px dashed ${l}`,borderBottom:`1px dashed ${l}`},className:"mt-5",children:e.jsxs("ul",{children:[e.jsx("li",{children:"Please double check if the address is correct before payment"}),e.jsx("li",{children:"Please double check if the address is correct before payment"}),e.jsx("li",{children:"Please double check if the address is correct before payment"})]})})})})]})}function Ce({cardActive:n}){var k;const{token:{buttonPrimary:d,textWhite:m}}=D.useToken(),a=i.useRef(),{listPaymentMethod:c,amount:u,setDepositItem:l,depositItem:h}=i.useContext(w),[p,s]=i.useState(),g=(r=h.id*T)=>{var t;s(!0);const f={payment_method_id:((t=a.current)==null?void 0:t.id)*T,deposit_id:r};ye(f).then(o=>{var y,v;s(!1),window.api.openLinkWebBrowser((v=(y=o==null?void 0:o.data)==null?void 0:y.content)==null?void 0:v.redirect_url)}).catch(o=>{s(!1),console.log("error handleCoinBaseCheckout",o)})},j=()=>{const r=c.find(t=>{if(t.method=="crypto")return t});a.current=r;const f={amount:Number(u)};O(f).then(t=>{var o;l((o=t==null?void 0:t.data)==null?void 0:o.content)})};i.useEffect(()=>{n=="crypto"&&j()},[n,u]);const P=()=>{g()};return e.jsx(e.Fragment,{children:((k=a.current)==null?void 0:k.id)!=null&&e.jsx(S,{style:{backgroundColor:d,color:m},onClick:P,className:"w-full border-none rounded py-1 my-7 font-bold",size:"large",loading:p,children:"Pay with Crypto"})})}function Pe({cardActive:n}){var k;const{token:{buttonPrimary:d,textWhite:m}}=D.useToken(),a=i.useRef(),{listPaymentMethod:c,amount:u,setDepositItem:l,depositItem:h}=i.useContext(w),[p,s]=i.useState(),g=(r=h.id*T)=>{var t;s(!0);const f={payment_method_id:((t=a.current)==null?void 0:t.id)*T,deposit_id:r};je(f).then(o=>{var y,v;s(!1),window.api.openLinkWebBrowser((v=(y=o==null?void 0:o.data)==null?void 0:y.content)==null?void 0:v.redirect_url)}).catch(o=>{s(!1),console.log("error handlePaypalCheckout",o)})},j=()=>{const r=c.find(t=>{if(t.method=="paypal")return t});a.current=r;const f={amount:Number(u)};O(f).then(t=>{var o;l((o=t==null?void 0:t.data)==null?void 0:o.content)})};i.useEffect(()=>{n=="paypal"&&j()},[n,u]);const P=()=>{g()};return e.jsx(e.Fragment,{children:((k=a.current)==null?void 0:k.id)!=null&&e.jsx(S,{style:{backgroundColor:d,color:m},onClick:P,className:"w-full border-none rounded py-1 my-7 font-bold",size:"large",loading:p,children:"Pay with Paypal"})})}function ve({cardActive:n}){const{Text:d}=M,{token:{textPrimary:m}}=D.useToken(),{amount:a,setAmount:c,setDepositItem:u}=i.useContext(w),[l,h]=i.useState(),[p]=F.useForm(),{t:s}=I(),g=()=>{p.submit()},j=t=>{t&&Number(t)>0&&c(t)},P=t=>{c(t),p.setFieldValue("amount",t)},k=[10,25,50,75,100,200],{mutate:r,isLoading:f}=me({mutationFn:t=>O(t),onError:t=>{xe.error("Error send token")},onSuccess:t=>{var o;switch(u((o=t==null?void 0:t.data)==null?void 0:o.content),n){case"bank":h(!0);break;default:h(!1);break}}});return e.jsxs("div",{className:"pl-12",children:[e.jsxs(d,{className:"font-bold text-[20px]",children:["2.",s("Deposit amount")]}),e.jsx(N,{className:"my-5",children:e.jsx(x,{span:24,children:e.jsx(F,{className:" flex space-x-5",form:p,onFinish:r,initialValues:{amount:a},onValuesChange:(t,o)=>j(t==null?void 0:t.amount),children:e.jsx(F.Item,{name:"amount",className:"w-full m-0",rules:[{required:!0,type:"number",min:1}],children:e.jsx(ue,{className:"w-full",parser:t=>t.replace(/[^\d]/g,""),formatter:t=>`${t}`.replace(/[^\d]/g,"")})})})})}),e.jsx(N,{children:e.jsx(x,{span:24,className:"flex justify-between",children:k.map((t,o)=>e.jsx("div",{children:e.jsx(S,{className:"capitalize",style:{minWidth:"80px"},onClick:()=>P(t),children:`$ ${t}`})},o))})}),e.jsx(N,{children:e.jsxs(x,{span:24,className:"text-center",children:[n=="bank"&&e.jsx(S,{block:!0,className:`my-7 font-bold bg-[#2263B3] text-[#FFFFFF] border-[${m}] rounded`,size:"large",onClick:g,loading:f,children:s("Pay now")}),n=="paypal"&&e.jsx(Pe,{cardActive:n}),n=="crypto"&&e.jsx(Ce,{cardActive:n})]})}),e.jsx(N,{children:e.jsxs(x,{span:24,children:[e.jsx(d,{className:`font-bold text-[20px] text-[${m}] block mb-2`,children:s("Note")}),e.jsxs(d,{className:"text-[14px] block mb-2",children:["1. ",s("This address is only for accepting USDT(TRC20). If you send other coins to this address, they cannot be reversed, and no compension will be made.")]}),e.jsxs(d,{className:"text-[14px] block",children:["2. ",s("This address is only for accepting USDT(TRC20). If you send other coins to this address, they cannot be reversed, and no compension will be made.")]})]})}),e.jsx(ge,{isModelOpen:l,setIsModelOpen:h})]})}function Be(){const{token:{colorLineGray:n}}=D.useToken(),{cardActive:d,setCardActive:m,setListPaymentMethod:a}=i.useContext(w),{t:c}=I(),u=[{key:"bank",title:c("Instant Bank Transfer"),listImg:[H],isDisabled:!1},{key:"paypal",title:c("Paypal"),listImg:[oe],isDisabled:!1},{key:"crypto",title:c("Coin Base"),listImg:[re],isDisabled:!1}];return W({queryFn:()=>ce(),queryKey:R.listPaymentMethod,onSuccess:async l=>{var h;a((h=l==null?void 0:l.data)==null?void 0:h.content)},refetchOnMount:!0}),e.jsxs(N,{children:[e.jsx(x,{span:12,style:{borderRight:`2px solid ${n}`},children:e.jsx(Ne,{listCardPay:u,setCardActive:m,cardActive:d})}),e.jsx(x,{span:12,children:e.jsx(ve,{cardActive:d})})]})}function ot(){var u,l;const{token:{textPrimary:n,textWhite:d}}=D.useToken(),{Text:m}=M,{data:a}=W({queryFn:()=>he(),queryKey:R.userDetail,refetchOnMount:!0}),{t:c}=I();return e.jsx(ke,{children:e.jsxs(N,{className:"pr-12 pl-7",children:[e.jsx(x,{span:24,children:e.jsx("div",{className:`w-full rounded p-7 my-9 ${Q["background-balance"]}`,children:e.jsxs(N,{children:[e.jsxs(x,{span:17,children:[e.jsx(m,{className:`text-[16px] font-bold block text-[${d}]`,children:c("Account information")}),e.jsx(m,{className:`text-[32px] block font-bold text-[${d}]`,children:c("BALANCE")})]}),e.jsxs(x,{span:7,className:"relative",children:[e.jsxs(m,{className:`text-[16px] mr-7 text-[${d}]`,children:[c("Total"),":"]}),e.jsx(m,{className:`text-[50px] font-bold text-[${d}]`,children:U({price:((l=(u=a==null?void 0:a.data)==null?void 0:u.content)==null?void 0:l.balance)??0,maximumFractionDigits:2})})]})]})})}),e.jsx(x,{span:24,children:e.jsx(Be,{})})]})})}export{ot as default};
